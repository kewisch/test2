---
name: PR Merged Actions

on:
  pull_request:
    branches: [main]
    types: [closed]

jobs:
  handle_merged_pr:
    runs-on: ubuntu-latest
    permissions:
      pull-requests: write

    steps:
      - name: Thank you
        if: |
         github.event.pull_request.merged == true
        #  github.event.pull_request.merged == true &&
        #  github.event.pull_request.author_association != 'OWNER' &&
        #  github.event.pull_request.author_association != 'MEMBER' &&
        #  github.event.pull_request.author_association != 'COLLABORATOR'
        env:
          PR_NUMBER: ${{  github.event.pull_request.number  }}
          GH_TOKEN: ${{ github.token }}
          MESSAGE: >-
            Thanks for your contribution! Your pull request has been merged. We appreciate the time
            and effort you put into improving Thunderbird. If you havenâ€™t already, youâ€™re welcome to
            join our Matrix chat for contributors. Itâ€™s where we discuss development and help each
            other out. https://matrix.to/#/#tb-android-dev:mozilla.org
.
            Hope to see you there! ğŸš€ğŸ“±ğŸ¦
        run: |
          gh pr comment $PR_NUMBER --repo $GITHUB_REPOSITORY --body "$MESSAGE"

      - name: Add to Milestone
        if: github.event.pull_request.merged == true
        uses: benelan/milestone-action@ae503769af66e741a9d7f76052058e1c3054fd7e  # v3.1.0
        with:
          farthest: true
